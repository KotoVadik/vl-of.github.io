<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ –¥–µ–ª | @vl-of</title>
    <link rel="icon" type="image/png" href="https://lh5.googleusercontent.com/uGbm73Mc2qj_OjcBOfqdTCFgr8Rz11u8lc-dYA_OEd20Pb7zftzeGf-H9GDnzhasyopkoqpuG5D7wpxd08YijOo=w1280">

    <style>
        body {
            background-color: #222; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
            color: #fff; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
            font-family: Arial, sans-serif; /* –®—Ä–∏—Ñ—Ç —Ç–µ–∫—Å—Ç–∞ */
            padding: 20px;
        }
        input[type="text"] {
            width: 300px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ */
            padding: 5px;
            font-size: 16px;
            background-color: #444; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ */
            color: #fff; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ */
            border: none;
            border-radius: 5px;
            margin-bottom: 10px; /* –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–±–µ–ª –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏ */
            margin-right: 10px;
        }
        button {
            padding: 5px; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø –∫–Ω–æ–ø–∫–∏ */
            font-size: 16px;
            background-color: #666; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∫–Ω–æ–ø–∫–∏ */
            color: #fff; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∫–Ω–æ–ø–∫–µ */
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #888; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
        button[type="submit"] {
            background-color: #888; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∫–Ω–æ–ø–∫–∏ "üíæ" */
        }
        .task {
            margin-bottom: 10px;
        }
        .archived-tasks ul {
            list-style-type: none;
            padding: 0;
        }
        .archived-tasks li {
            margin-bottom: 10px;
            border-bottom: 1px solid #555; /* –¶–≤–µ—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è –º–µ–∂–¥—É –∑–∞–¥–∞–Ω–∏—è–º–∏ */
            padding-bottom: 10px;
        }
        .archive-active {
            background-color: #333; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –±–ª–æ–∫–∞ –∞—Ä—Ö–∏–≤–∞ */
            padding: 10px;
            border-radius: 5px;
        }
        .archive-active button {
            background-color: #666; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∫–Ω–æ–ø–∫–∏ –≤ –±–ª–æ–∫–µ –∞—Ä—Ö–∏–≤–∞ */
        }
        .date-header {
            color: #aaa; /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–∞—Ç—ã */
            margin-top: 10px; /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–∞—Ç—ã */
            margin-bottom: 5px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–∞—Ç—ã */
        }
        .task-info {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <form method="POST" action="/">
        <input type="text" name="input_text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç">
        <button type="submit">üíæ</button>
    </form>

    <br><br> <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–±–µ–ª –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏ -->

    {% if tasks %}
        <div class="tasks">
            {% for task in tasks %}
                <div class="task">
                    <form id="archiveForm{{ task.id }}" method="POST" action="/archive/{{ task.id }}" style="display: inline;">
                        <button type="button" onclick="archiveTask({{ task.id }})">‚úÖ</button>
                    </form>
                    <label>{{ task.content }}</label>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <br><br>
    <button type="button" onclick="showArchive()">–ê—Ä—Ö–∏–≤ ‚¨áÔ∏è</button>
    <div id="archive" class="archive-active" style="display: none;">
        {% if archived_tasks %}
            <div class="archived-tasks">
                <ul>
                    {% set current_date = '' %}
                    {% for task in archived_tasks %}
                        {% if task.created_at.strftime('%d.%m') != current_date %}
                            <div class="date-header">{{ task.created_at.strftime('%d.%m') }}</div>
                            {% set current_date = task.created_at.strftime('%d.%m') %}
                        {% endif %}
                        <li>
                            <div class="task-info">
                                <label>{{ task.content }}</label>
                            </div>
                            <div class="task-buttons">
                                <form id="restoreForm{{ task.id }}" method="POST" action="/restore/{{ task.id }}" style="display: inline;">
                                    <button type="button" onclick="restoreTask({{ task.id }})">üîô</button>
                                </form>
                                <form id="deleteForm{{ task.id }}" method="POST" action="/delete/{{ task.id }}" style="display: inline;">
                                    <button type="button" onclick="deleteTask({{ task.id }})">üóëÔ∏è</button>
                                </form>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
                <button type="button" onclick="clearArchive()">–û—á–∏—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤</button>
            </div>
        {% endif %}
    </div>

    <script>
        function showArchive() {
            var archive = document.getElementById("archive");
            archive.style.display = archive.style.display === "none" ? "block" : "none";
        }

        function archiveTask(taskId) {
            document.getElementById("archiveForm" + taskId).submit();
        }

        function restoreTask(taskId) {
            document.getElementById("restoreForm" + taskId).submit();
        }

        function deleteTask(taskId) {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ?")) {
                document.getElementById("deleteForm" + taskId).submit();
            }
        }

        function clearArchive() {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤?")) {
                fetch('/clear_archive', { method: 'POST' })
                    .then(response => {
                        if (response.ok) {
                            window.location.reload();
                        } else {
                            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –∞—Ä—Ö–∏–≤–∞');
                        }
                    });
            }
        }
    </script>
</body>
</html>